# -*- mode: org; coding: utf-8-unix; indent-tabs-mode: nil -*-
#
# Copyright(C) Youhei SASAKI All rights reserved.
# $Lastupdate: 2012/03/29 21:35:43$
# License: Expat
#
#+TITLE: yasnippetの設定
#+AUTHOR: Youhei SASAKI
#+EMAIL: uwabami@gfd-dennou.org
* 始めに
  本家より
  #+BEGIN_QUOTE
  YASnippet は、Emacs のためのテンプレートシステムです。省略形でタイプすると、自動的に関数テンプレートに展開してくれます。次の言語向けのテンプレートが同梱されています： C, C++, C#, Perl, Python, Ruby, SQL, LaTeX, HTML, CSS, ...
  #+END_QUOTE
  詳細は [[http://yasnippet-doc-jp.googlecode.com/svn/trunk/doc-jp/index.html][Yet Another Snippet extension]] [fn:1] 参照のこと.
  Debianでは [[http://packages.qa.debian.org/y/yasnippet.html][yasnippet]] [fn:15] としてパッケージ化されている.
  パッケージが無い場合には ELPA で導入すること.
* 設定
  yasnippet のキーバインドと org-mode のキーバインドがぶつかる [fn:3]
  のでそれをなんとかするのがまず最初.
  #+BEGIN_SRC emacs-lisp
    (add-to-load-path "site-lisp/yasnippet")
    (require 'yasnippet)
    (setq yas/snippet-dirs
          (list
           (concat my:user-emacs-share-directory "yasnippet/snippets")
           (concat user-emacs-directory "site-lisp/yasnippet/snippets")))
    (yas/global-mode 1) ; <- (yas/initialize)
    ;; (require 'dropdown-list)
    ;; (setq yas/prompt-functions '(yas/dropdown-prompt
    ;;                              yas/ido-prompt
    ;;                              yas/completing-prompt))
    ;; org-mode のための回避策
    (eval-after-load "yasnippet"
      '(progn
         (defun yas/org-very-safe-expand ()
           (let ((yas/fallback-behavior 'return-nil)) (yas/expand)))
         ))
    (add-hook 'org-mode-hook
              (lambda ()
                (make-variable-buffer-local 'yas/trigger-key)
                (setq yas/trigger-key [tab])
                (add-to-list 'org-tab-first-hook 'yas/org-very-safe-expand)
                (define-key yas/keymap [tab] 'yas/next-field)))
  #+END_SRC
* Footnotes

[fn:1] Yet Another Snippet extension: [[http://yasnippet-doc-jp.googlecode.com/svn/trunk/doc-jp/index.html]]

[fn:2] yasnippet - Debian PTS: [[http://packages.qa.debian.org/y/yasnippet.html]]

[fn:3] Packages that lead to conflicts with Org mode: [[http://orgmode.org/manual/Conflicts.html]]

