# -*- mode: org; coding: utf-8-unix; indent-tabs-mode: nil -*-
#
# Copyright(C) Youhei SASAKI All rights reserved.
# $Lastupdate: 2013/07/01 17:19:38$
# License: Expat
#
#+TITLE: MUA の設定
#+AUTHOR: Youhei SASAKI
#+EMAIL: uwabami@gfd-dennou.org
#+SETUPFILE: ./export-config.org
#+BEGIN_HTML
---
layout: emacs
title: MUA の設定
---
#+END_HTML
* 始めに
  MUA として [[http://www.mew.org/ja/][Mew]] [fn:1]
  もしくは  [[https://github.com/wanderlust/wanderlust][Wanderlust]] [fn:2] を使っている.
  ここでは =mail-user-agent= で
  上記いずれかを呼び出す設定のみをしている.
* 条件分岐用の switch 変数
  このファイル自体が読み込まれるのは,
  以下で設定した =my:wl-use= もしくは =my:mew-use= のどちらかが =t= となっている場合のみ.
  なので, これら変数を使って, Mew を使うのか Wanderlust を使うのかを switch する.
  両方 =t= の場合には Wanderlust を優先.
  #+BEGIN_SRC emacs-lisp
    (defvar my:wl-use
      (and (locate-library "wl")
           (file-exists-p (concat user-emacs-directory ".wl-use"))))
    (defvar my:mew-use
      (and (locate-library "mew")
           (file-exists-p (concat user-emacs-directory ".mew-use"))))
  #+END_SRC
* MUA の設定
  =mail-user-agent= での呼出を設定
  #+BEGIN_SRC emacs-lisp
    (cond
     (my:wl-use
      (autoload 'wl "wl" "Wanderlust" t)
      (autoload 'wl-other-frame "wl" "Wanderlust on new frame" t)
      (autoload 'wl-draft "wl-draft" "Write draft with Wanderlust." t)
      (if (boundp 'mail-user-agent)
          (setq mail-user-agent 'wl-user-agent))
      (if (boundp 'read-mail-command)
          (setq read-mail-command 'wl))
      (if (fboundp 'define-mail-user-agent)
          (define-mail-user-agent
            'wl-user-agent
            'wl-user-agent-compose
            'wl-draft-send
            'wl-draft-kill
            'mail-send-hook)))
     (my:mew-use
      (autoload 'mew "mew" nil t)
      (autoload 'mew-send "mew" nil t)
      (setq read-mail-command 'mew)
      (autoload 'mew-user-agent-compose "mew" nil t)
      (if (boundp 'mail-user-agent)
          (setq mail-user-agent 'mew-user-agent))
      (if (fboundp 'define-mail-user-agent)
          (define-mail-user-agent
            'mew-user-agent
            'mew-user-agent-compose
            'mew-draft-send-message
            'mew-draft-kill
            'mew-send-hook)))
     (t
      ;;
      ))
  #+END_SRC
* Wanderlust の呼び出し設定
  やっていることは
  - =~/.elmo= の場所の変更
  - org で書かれた設定ファイルから elisp を抽出して compile
  - 設定ファイルの位置の変更
  である.
  Wanderlust の設定自体は [[file:wl_config.org][Wanderlust の設定]] を参照の事
  #+BEGIN_SRC emacs-lisp
    (when my:wl-use
      (progn
        (setq elmo-msgdb-directory "~/Mail/elmo")
        (my:org-babel-tangle-and-compile-file
         (concat my:user-emacs-config-directory "wl_config.org"))
        (setq wl-init-file
              (concat my:user-emacs-config-directory "wl_config"))))
  #+END_SRC
* Mew の呼び出し設定
  Mew の設定自体は [[file:mew_config.org][Mew の設定]] を参照の事
  #+BEGIN_SRC emacs-lisp
    (when my:mew-use
      (progn
        (setq mew-rc-file
              (concat my:user-emacs-config-directory "mew_config"))
        (setq mew-addrbook-file "~/.mua/Addrbook.mew")
        (my:org-babel-tangle-and-compile-file
         (concat my:user-emacs-config-directory "mew_config.org"))))
  #+END_SRC
* Footnotes

[fn:1] Mew のオフィシャルページ:  [[http://www.mew.org/ja/]]

[fn:2] Wanderlust: [[https://github.com/wanderlust/wanderlust]]
