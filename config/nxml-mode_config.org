# -*- mode: org; coding: utf-8-unix; indent-tabs-mode: nil -*-
#
# Copyright(C) Youhei SASAKI All rights reserved.
# $Lastupdate: 2012/09/12 22:57:57$
# License: Expat
#
#+TITLE: nxml-mode の設定
#+AUTHOR: Youhei SASAKI
#+EMAIL: uwabami@gfd-dennou.org
#+SETUPFILE: ./export-config.org
#+BEGIN_HTML
---
layout: emacs
title: nxml-mode の設定
---
#+END_HTML
* 始めに
  HTML/XML を手で書くことはもう殆んどないのだけれども,
  一応設定しておく.
* HTML5 の rng scheme の追加
  #+BEGIN_SRC emacs-lisp
    (unless (locate-library "whattf-dt")
      (el-get 'sync 'html5-github))
    (eval-when-compile (require 'whattf-dt nil t))
  #+END_SRC
* 設定
  #+BEGIN_SRC emacs-lisp
    (eval-when-compile (require 'nxml-mode))
    (autoload 'nxml-mode "nxml-mode" nil t)
    ;; html は nxml-mode
    (add-to-list 'auto-mode-alist
                 '("\\.[sx]?html?\\(\\.[a-zA-z_]+\\)?\\'" . nxml-mode))
    (fset 'html-mode 'nxml-mode)
    ;; xml も nxml-mode
    (add-to-list 'auto-mode-alist
                 (cons (concat "\\." (regexp-opt '("xml" "xsd" "sch" "rng" "xslt" "svg" "rss") t) "\\'")
                       'nxml-mode))
    (setq magic-mode-alist
          (cons '("<\ \?xml " . nxml-mode) magic-mode-alist))
    (fset 'xml-mode 'nxml-mode)
    ;; </ の補完
    (setq nxml-slash-auto-complete-flag t)
    ;; M-TAB での補完 <- 補完は auto-complete があるのでいらないかも
    (setq nxm-bind-meta-tab-to-complete-flag t)
    ;; nxml-mode で auto-complete-mode を有効に
    (add-to-list 'ac-modes 'nxml-mode)
    ;; インデントの調整
    (setq nxml-child-indent 2)     ; <- デフォルト
    (setq nxm-attribute-indent 4 ) ; <- デフォルト
  #+END_SRC
