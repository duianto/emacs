language: generic
dist: trusty
sudo: required
env:
  matrix:
    - EMACS=emacs25
  allow_failures:
    - EMACS=emacs-snapshot
before_install:
  - ln -s $TRAVIS_BUILD_DIR ~/.emacs.d
  - export PATH="$HOME/.emacs.d/share/cask/bin:$PATH"
  - if [ x"$EMACS" == x"emacs25" ]; then
    sudo apt-add-repository -y ppa:adrozdoff/emacs &&
    sudo apt-get update -qq &&
    sudo apt-get install -qq emacs25 emacs25-el;
    fi
  - if [ x"$EMACS" == x"emacs-snapshot" ]; then
    sudo add-apt-repository -y ppa:ubuntu-elisp/ppa &&
    sudo apt-get update -qq &&
    sudo apt-get install -qq emacs-snapshot emacs-snapshot-el;
    fi
  - EMACS=$EMACS cask --verbose --debug
script:
  - make EMACS=$EMACS
  - make clean
  - make distclean
